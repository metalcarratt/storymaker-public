(function(e){function t(t){for(var a,r,o=t[0],i=t[1],l=t[2],d=0,h=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&h.push(n[r][0]),n[r]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);u&&u(t);while(h.length)h.shift()();return c.push.apply(c,l||[]),s()}function s(){for(var e,t=0;t<c.length;t++){for(var s=c[t],a=!0,o=1;o<s.length;o++){var i=s[o];0!==n[i]&&(a=!1)}a&&(c.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},n={app:0},c=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=i;c.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},c=[],r={name:"App"},o=r,i=(s("5c0b"),s("2877")),l=Object(i["a"])(o,n,c,!1,null,null,null),u=l.exports,d=(s("99af"),s("2f62")),h=s("ec26"),p=(s("4de4"),s("c740"),s("a434"),s("b0c0"),"stories"),f="story",m="assetPack",v="assetPackKeys",y=function(e){window.console.log("MyLocalStorage # [STORE] getItem ("+e+")");var t=window.localStorage.getItem(e);return window.console.log("RES: "+t),JSON.parse(t)},w=function(e,t){window.console.log("MyLocalStorage # [STORE] setItem ("+e+")");var s=JSON.stringify(t);window.console.log("RES: "+s),window.localStorage.setItem(e,s)},g=function(e){window.console.log("MyLocalStorage # [STORE] removeItem ("+e+")"),window.localStorage.removeItem(e)},k={loadStoryKeys:function(){window.console.log("MyLocalStorage # [story] loadStoryKeys");var e=y(p);return e||[]},saveStoryKeys:function(e){window.console.log("MyLocalStorage # [story] saveStoryKeys (storyKeys)"),window.console.log(e),w(p,e)},saveStory:function(e){window.console.log("MyLocalStorage # [story] saveStory (story)"),window.console.log(e);var t=this.loadStoryKeys(),s={id:e.id,name:e.title},a=t.findIndex((function(t){return t.id===e.id}));-1===a?(t.push(s),this.saveStoryKeys(t)):t.splice(a,1,s),this.saveStoryKeys(t);var n=f+"."+e.id;w(n,e)},loadStory:function(e){window.console.log("MyLocalStorage # [story] loadStory (storyId)"),window.console.log(e);var t=f+"."+e;return y(t)},loadAssetPack:function(e){window.console.log("MyLocalStorage # [assets] loadAssetPack (id)"),window.console.log(e);var t=m+"."+e;return y(t)},saveAssetPack:function(e){window.console.log("MyLocalStorage # [assets] saveAssetPack (assetPack)"),window.console.log(e);var t=this.loadAssetPackKeys(),s=t.findIndex((function(t){return t.id===e.id}));window.console.log("index is "+s);var a={id:e.id,name:e.name};-1===s?(t.push(a),this.saveAssetPackKeys(t)):t.splice(s,1,a),this.saveAssetPackKeys(t);var n=m+"."+e.id;w(n,e)},loadAssetPackKeys:function(){window.console.log("MyLocalStorage # [assets] loadAssetPackKeys");var e=y(v);return e||[]},saveAssetPackKeys:function(e){window.console.log("MyLocalStorage # [assets] saveAssetPackKeys (assetPackKeys"),window.console.log(e),w(v,e)},deleteAssetPack:function(e){window.console.log("MyLocalStorage # [assets] deleteAssetPack (assetPackId)"),window.console.log(e);var t=this.loadAssetPackKeys();t=t.filter((function(t){return t.id!==e})),this.saveAssetPackKeys(t);var s=m+"."+e;g(s)}};a["a"].use(d["a"]);var b=new d["a"].Store({state:{story:{id:Object(h["a"])(),scenes:[],characters:[],plan:[]},stories:k.loadStoryKeys(),assetPacks:k.loadAssetPackKeys()},getters:{story:function(e){return window.console.log("getting story in store"),window.console.log("story is"),window.console.log(e.story),e.story},stories:function(e){return e.stories},assetPacks:function(){return k.loadAssetPackKeys()},assetPack:function(){return function(e){return k.loadAssetPack(e)}}},mutations:{update:function(e,t){window.console.log("updating story in store"),e.story=t},openNew:function(e){e.story={id:Object(h["a"])(),title:"",scenes:[],characters:[],plan:[]}},close:function(e){e.story={}},save:function(e,t){this.state.story=t,k.saveStory(e.story),e.stories=k.loadStoryKeys()},load:function(e,t){e.story=k.loadStory(t)},updateAssetPack:function(e,t){k.saveAssetPack(t)},importAssetsToStory:function(e,t){t.scenes&&(e.story.scenes=e.story.scenes.concat(t.scenes)),t.characters&&(e.story.characters=e.story.characters.concat(t.characters))},deleteAssetPack:function(e,t){k.deleteAssetPack(t)}}}),_=s("8c4f"),C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v("Story Maker")]),s("h2",[e._v("Stories")]),s("button",{staticClass:"wideMenu button",on:{click:e.newStory}},[e._v("New")]),e._l(e.stories,(function(t){return s("button",{key:t.id,staticClass:"wideMenu button",on:{click:function(s){return e.loadStory(t)}}},[e._v("Load "+e._s(t.name))])})),s("hr"),s("AssetMenu")],2)},x=[],S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",[e._v("Asset Packs")]),s("button",{staticClass:"wideMenu button",attrs:{title:"Create a new asset pack"},on:{click:e.newPack}},[e._v("New")]),e._l(e.assetPacks,(function(t){return s("button",{key:t.id,staticClass:"wideMenu button",attrs:{title:"View asset pack "+t.name},on:{click:function(s){return e.viewPack(t)}}},[e._v(e._s(t.name))])})),s("button",{staticClass:"wideMenu button",attrs:{title:"Download new asset packs from the cloud"},on:{click:e.download}},[e._v("Download from Cloud")])],2)},P=[],A={computed:{assetPacks:function(){return this.$store.getters.assetPacks}},methods:{newPack:function(){this.$router.push("/assets/update/new")},viewPack:function(e){this.$router.push("/assets/view/"+e.id)},download:function(){this.$router.push("assets/download")}}},$=A,O=Object(i["a"])($,S,P,!1,null,null,null),j=O.exports,M={components:{AssetMenu:j},computed:{stories:function(){return this.$store.getters.stories}},methods:{newStory:function(){this.$store.commit("openNew"),this.$router.push("/menu")},loadStory:function(e){this.$store.commit("load",e.id),this.$router.push("/menu")}}},I=M,T=Object(i["a"])(I,C,x,!1,null,null,null),D=T.exports,E=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v(e._s(e.story.title?e.story.title:"New Story"))]),s("button",{staticClass:"wideMenu button",on:{click:function(t){return e.$router.push("/play")}}},[e._v("Play")]),s("button",{staticClass:"wideMenu button",on:{click:function(t){return e.$router.push("/edit")}}},[e._v("Edit")]),s("button",{staticClass:"wideMenu button",on:{click:e.close}},[e._v("Close")]),s("hr"),s("UploadFile",{attrs:{labelClass:"wideMenu",text:!0,id:"uploadStory",label:"Import"},model:{value:e.importedStory,callback:function(t){e.importedStory=t},expression:"importedStory"}}),s("button",{staticClass:"wideMenu button",on:{click:e.exportStory}},[e._v("Export")]),s("AssetMenu")],1)},N=[],L=(s("d3b7"),s("ac1f"),s("3ca3"),s("5319"),s("ddb0"),s("2b3d"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"upload"},[s("input",{attrs:{id:e.getId,type:"file"},on:{change:function(t){return e.uploadFile(t)}}}),s("label",{class:["button",e.labelClass],attrs:{for:e.getId}},[e._v(e._s(e.label?e.label:"Upload"))])])}),K=[],R={props:["value","text","id","label","labelClass"],data:function(){return{reader:new FileReader}},mounted:function(){this.reader.addEventListener("load",this.whenFileLoaded,!1)},computed:{getId:function(){return this.id?this.id:"file"}},methods:{uploadFile:function(e){window.console.log("upload file clicked");var t=e.target.files[0];this.text?(window.console.log("it's text"),this.reader.readAsText(t)):this.reader.readAsDataURL(t)},whenFileLoaded:function(){window.console.log("file loaded"),this.$emit("input",this.reader.result)}}},F=R,U=Object(i["a"])(F,L,K,!1,null,null,null),B=U.exports,J={components:{UploadFile:B,AssetMenu:j},data:function(){return{importedStory:{}}},computed:{story:function(){return window.console.log("getting story"),this.$store.getters.story}},watch:{importedStory:function(e){window.console.log("story imported"),this.$store.commit("update",JSON.parse(e))}},methods:{close:function(){this.$store.commit("close"),this.$router.push("/")},exportStory:function(){this.download(JSON.stringify(this.story),this.story.title.replace(/\s/g,""),"json")},download:function(e,t,s){var a=new Blob([e],{type:s});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var n=document.createElement("a"),c=URL.createObjectURL(a);n.href=c,n.download=t,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(c)}),0)}}}},z=J,W=Object(i["a"])(z,E,N,!1,null,null,null),q=W.exports,H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v("Story Maker - Editor")]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:e.save}},[e._v("Save")]),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/play")}}},[e._v("Play")]),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/menu")}}},[e._v("Back")])]),s("span",{staticClass:"field"},[s("label",[e._v("Story title")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.story.title,expression:"story.title"}],attrs:{type:"text"},domProps:{value:e.story.title},on:{input:function(t){t.target.composing||e.$set(e.story,"title",t.target.value)}}})]),s("h2",[e._v("Scenes")]),s("p",[e._v(e._s(e.story.scenes?e.story.scenes.length:0)+" scenes")]),s("ul",e._l(e.story.scenes,(function(t,a){return s("li",{key:a},[e._v(e._s(t.name))])})),0),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/edit/scenes")}}},[e._v("Edit Scenes")]),s("h2",[e._v("Characters")]),s("p",[e._v(e._s(e.story.characters?e.story.characters.length:0)+" characters")]),s("ul",e._l(e.story.characters,(function(t,a){return s("li",{key:a},[e._v(e._s(t.name))])})),0),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/edit/characters")}}},[e._v("Edit Characters")]),s("h2",[e._v("Plan")]),s("p",[e._v(e._s(e.story.plan?e.story.plan.length:0)+" steps in plan")]),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/edit/plan")}}},[e._v("Edit Plan")])])},Q=[],V={name:"Editor",data:function(){return{uploadStory:"",story:{}}},mounted:function(){this.story=this.$store.getters.story},methods:{downloadStory:function(){this.download(JSON.stringify(this.story),"my","story")},save:function(){this.$store.commit("save",this.story)}}},Y=V,G=Object(i["a"])(Y,H,Q,!1,null,null,null),X=G.exports,Z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h2",[e._v("Scenes")]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:e.addScene}},[e._v("New Scene")]),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/edit")}}},[e._v("Back")])]),s("ul",{staticClass:"editlist box"},e._l(e.scenes,(function(t){return s("li",{key:t.id},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"scene.name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:t.name},on:{input:function(s){s.target.composing||e.$set(t,"name",s.target.value)}}}),s("img",{attrs:{src:t.image}}),s("span",{staticClass:"buttons"},[s("UploadFile",{attrs:{id:"uploadScene"+t.id},model:{value:t.image,callback:function(s){e.$set(t,"image",s)},expression:"scene.image"}}),s("button",{staticClass:"button danger",on:{click:function(s){return e.deleteScene(t)}}},[e._v("Delete")])],1)])})),0)])},ee=[],te=(s("c975"),{components:{UploadFile:B},data:function(){return{scenes:[],checkedScenes:[]}},mounted:function(){this.scenes=this.$store.getters.story.scenes},methods:{addScene:function(){this.scenes.push({id:Object(h["a"])(),name:"",image:""})},deleteScene:function(e){this.scenes.splice(this.scenes.indexOf(e),1)}}}),se=te,ae=(s("66dc"),Object(i["a"])(se,Z,ee,!1,null,"37e6d2f1",null)),ne=ae.exports,ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h2",[e._v("Characters")]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:e.addCharacter}},[e._v("New Character")]),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/edit")}}},[e._v("Back")])]),s("ul",{staticClass:"editlist box"},e._l(e.characters,(function(t){return s("li",{key:t.id},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"character.name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:t.name},on:{input:function(s){s.target.composing||e.$set(t,"name",s.target.value)}}}),s("img",{attrs:{src:t.image}}),s("span",{staticClass:"field"},[s("label",[e._v("Speech Box Colour")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.colour,expression:"character.colour"}],attrs:{type:"color"},domProps:{value:t.colour},on:{input:function(s){s.target.composing||e.$set(t,"colour",s.target.value)}}})]),s("span",{staticClass:"field"},[s("label",[e._v("Y-Offset")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.yoffset,expression:"character.yoffset"}],attrs:{type:"number"},domProps:{value:t.yoffset},on:{input:function(s){s.target.composing||e.$set(t,"yoffset",s.target.value)}}})]),s("span",{staticClass:"field"},[s("label",[e._v("Scale")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.scale,expression:"character.scale"}],attrs:{type:"number"},domProps:{value:t.scale},on:{input:function(s){s.target.composing||e.$set(t,"scale",s.target.value)}}})]),s("Canvas",{attrs:{id:"canvas"+t.id,width:304,height:190,character:t,text:"Hi"}}),s("span",{staticClass:"buttons"},[s("UploadFile",{attrs:{id:"uploadCharacter"+t.id},model:{value:t.image,callback:function(s){e.$set(t,"image",s)},expression:"character.image"}}),s("button",{staticClass:"button danger",on:{click:function(s){return e.deleteCharacter(t)}}},[e._v("Delete")])],1)],1)})),0)])},re=[],oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("canvas",{attrs:{id:e.id,width:e.width,height:e.height},on:{click:function(t){return e.$emit("nextStep")}}})},ie=[],le=s("1157"),ue=s.n(le),de=s("acea"),he=s.n(de);he()(ue.a,window);var pe={props:["id","width","height","scene","character","text"],data:function(){return{characterImageMeta:{width:0,height:0}}},mounted:function(){window.console.log(""),window.console.log(this.id+" mounted"),this.loadMetadata(),this.draw()},watch:{scene:{handler:function(){window.console.log(""),window.console.log(this.id+" scene updated"),this.draw()},deep:!0},character:{handler:function(){window.console.log(""),window.console.log(this.id+" character updated"),this.loadMetadata()},deep:!0},characterImageMeta:{handler:function(){window.console.log(""),window.console.log(this.id+" image meta updated"),this.draw()},deep:!0},text:function(){window.console.log(""),window.console.log(this.id+" text updated"),this.draw()}},computed:{xscale:function(){return this.width/800},yscale:function(){return this.height/500}},methods:{draw:function(){window.console.log(this.id+" draw ******"),window.console.log("scene? "+(!1!==this.scene)),window.console.log("character? "+(!1!==this.character));var e=this.id?ue()("#"+this.id):ue()("canvas");e.clearCanvas(),this.drawBorder(e),this.drawScene(e),this.drawCharacter(e),this.drawText(e)},drawBorder:function(e){e.drawRect({strokeStyle:"#c33",strokeWidth:1,x:1,y:1,width:this.width-2,height:this.height-2,fromCenter:!1})},drawScene:function(e){this.scene&&this.scene.image&&e.drawImage({source:this.scene.image,x:2,y:2,width:this.width-4,height:this.height-4,scale:1,fromCenter:!1})},drawCharacter:function(e){if(this.character&&this.character.image){var t=200*this.yscale+(this.character.yoffset?5*parseInt(this.character.yoffset):0),s=this.character.scale?parseFloat(this.character.scale):1;window.console.log("width: "+this.characterImageMeta.width*this.xscale),window.console.log("height: "+this.characterImageMeta.height*this.yscale),e.drawImage({source:this.character.image,x:10*this.xscale,y:t,width:this.characterImageMeta.width*this.xscale*s,height:this.characterImageMeta.height*this.yscale*s,fromCenter:!1})}},drawText:function(e){var t=this.character.colour?this.character.colour:"#69A0D7",s="#2D4258",a="#ECF3FA";e.drawRect({fillStyle:t,x:20*this.xscale,y:20*this.yscale,width:770*this.xscale,height:80*this.yscale,fromCenter:!1,cornerRadius:4}),e.drawRect({strokeStyle:s,x:24*this.xscale,y:24*this.yscale,width:762*this.xscale,height:72*this.yscale,fromCenter:!1,cornerRadius:2}),e.drawText({name:"drawText",fillStyle:a,strokeWidth:1,x:34*this.xscale,y:34*this.yscale,fontSize:18*this.xscale+"pt",fromCenter:!1,text:'"'+this.text+'"'}),e.drawText({name:"drawText",fillStyle:a,strokeWidth:1,x:45*this.xscale,y:74*this.yscale,fontSize:18*this.xscale+"pt",text:"..."})},loadMetadata:function(){var e=this,t=new Image;t.onload=function(){window.console.log("loaded metadata"),e.characterImageMeta.width=t.width,e.characterImageMeta.height=t.height,e.draw()},t.src=this.character.image}}},fe=pe,me=Object(i["a"])(fe,oe,ie,!1,null,null,null),ve=me.exports,ye={components:{UploadFile:B,Canvas:ve},data:function(){return{characters:[]}},mounted:function(){this.characters=this.$store.getters.story.characters},methods:{addCharacter:function(){this.characters.push({id:Object(h["a"])(),name:"",image:"",colour:"#69A0D7",yoffset:0,scale:1})},deleteCharacter:function(e){this.characters.splice(this.characters.indexOf(e),1)}}},we=ye,ge=(s("83d7"),Object(i["a"])(we,ce,re,!1,null,"7ad5c17b",null)),ke=ge.exports,be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h2",[e._v("Plan")]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:e.newItem}},[e._v("New")]),s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/edit")}}},[e._v("Back")])]),s("ul",{staticClass:"editlist"},e._l(e.plan,(function(t,a){return s("li",{key:a},[s("span",{staticClass:"number"},[e._v(e._s(a+1))]),s("span",{staticClass:"content"},[void 0!==t.scene?s("span",{staticClass:"field"},[s("label",[e._v("Scene: ")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.scene,expression:"item.scene"}],on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"scene",s.target.multiple?a:a[0])}}},e._l(e.scenes,(function(t,a){return s("option",{key:a},[e._v(e._s(t.name))])})),0)]):s("button",{staticClass:"button small",on:{click:function(s){return e.changeScene(t)}}},[e._v("Change scene")]),void 0!==t.character?s("span",{staticClass:"field"},[s("label",[e._v("Character: ")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.character,expression:"item.character"}],on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"character",s.target.multiple?a:a[0])}}},e._l(e.characters,(function(t,a){return s("option",{key:a},[e._v(e._s(t.name))])})),0)]):s("button",{staticClass:"button small",on:{click:function(s){return e.changeCharacter(t)}}},[e._v("Change character")]),s("span",{staticClass:"field"},[s("label",[e._v("Message: ")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"item.text"}],domProps:{value:t.text},on:{input:function(s){s.target.composing||e.$set(t,"text",s.target.value)}}})])])])})),0)])},_e=[],Ce={data:function(){return{plan:[],scenes:[],characters:[]}},mounted:function(){this.plan=this.$store.getters.story.plan,this.scenes=this.$store.getters.story.scenes,this.characters=this.$store.getters.story.characters},methods:{newItem:function(){this.plan.push({scene:void 0,character:void 0,text:""})},changeScene:function(e){e.scene=""},changeCharacter:function(e){e.character=""}}},xe=Ce,Se=Object(i["a"])(xe,be,_e,!1,null,null,null),Pe=Se.exports,Ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v(e._s(e.story.title))]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:function(t){return e.$router.push("/menu")}}},[e._v("Stop")])]),s("Canvas",{attrs:{id:"canvas1",width:800,height:500,scene:this.scene,character:this.character,text:e.text},on:{nextStep:e.nextStep}})],1)},$e=[];s("7db0");he()(ue.a,window);var Oe={name:"Play",components:{Canvas:ve},data:function(){return{story:{},scene:{},character:{},characterImageMeta:{width:0,height:0},text:"",index:0}},mounted:function(){this.story=this.$store.getters.story,this.update()},methods:{update:function(){var e=this.story.plan[this.index];e.scene&&(this.scene=this.story.scenes.find((function(t){return t.name===e.scene}))),e.character&&(this.character=this.story.characters.find((function(t){return t.name===e.character}))),e.text&&(this.text=e.text),this.loadMetadataAndDraw()},nextStep:function(){this.index++,this.index>=this.story.plan.length?this.$router.push("/"):this.update()},loadMetadataAndDraw:function(){var e=this,t=new Image;t.onload=function(){e.characterImageMeta.width=t.width,e.characterImageMeta.height=t.height},t.src=this.character.image}}},je=Oe,Me=Object(i["a"])(je,Ae,$e,!1,null,null,null),Ie=Me.exports,Te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v("Update Assets")]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:e.save}},[e._v("Save")]),s("button",{staticClass:"button",on:{click:e.back}},[e._v("Back")])]),s("h2",[e._v("Asset pack")]),s("span",{staticClass:"field"},[s("label",[e._v("Name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.assetPack.name,expression:"assetPack.name"}],attrs:{type:"text"},domProps:{value:e.assetPack.name},on:{input:function(t){t.target.composing||e.$set(e.assetPack,"name",t.target.value)}}})]),s("hr"),s("h2",[e._v("Current assets")]),s("button",{staticClass:"button danger",on:{click:e.removeAssets}},[e._v("Remove")]),s("h3",[e._v("Scenes")]),s("ul",e._l(e.assetPack.scenes,(function(t,a){return s("li",{key:a},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedScenesToDelete,expression:"selectedScenesToDelete"}],attrs:{type:"checkbox",id:"scene"+a},domProps:{value:t.name,checked:Array.isArray(e.selectedScenesToDelete)?e._i(e.selectedScenesToDelete,t.name)>-1:e.selectedScenesToDelete},on:{change:function(s){var a=e.selectedScenesToDelete,n=s.target,c=!!n.checked;if(Array.isArray(a)){var r=t.name,o=e._i(a,r);n.checked?o<0&&(e.selectedScenesToDelete=a.concat([r])):o>-1&&(e.selectedScenesToDelete=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedScenesToDelete=c}}}),s("label",{attrs:{for:"scene"+a}},[e._v(e._s(t.name))])])})),0),s("h3",[e._v("Characters")]),s("ul",e._l(e.assetPack.characters,(function(t,a){return s("li",{key:a},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedCharactersToDelete,expression:"selectedCharactersToDelete"}],attrs:{type:"checkbox",id:"character"+a},domProps:{value:t.name,checked:Array.isArray(e.selectedCharactersToDelete)?e._i(e.selectedCharactersToDelete,t.name)>-1:e.selectedCharactersToDelete},on:{change:function(s){var a=e.selectedCharactersToDelete,n=s.target,c=!!n.checked;if(Array.isArray(a)){var r=t.name,o=e._i(a,r);n.checked?o<0&&(e.selectedCharactersToDelete=a.concat([r])):o>-1&&(e.selectedCharactersToDelete=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedCharactersToDelete=c}}}),s("label",{attrs:{for:"character"+a}},[e._v(e._s(t.name))])])})),0),s("hr"),s("h2",[e._v("Add from existing project")]),s("button",{staticClass:"button",on:{click:e.addUpdateAssetPack}},[e._v("Add")]),s("h3",[e._v("Scenes")]),s("ul",e._l(e.story.scenes,(function(t,a){return s("li",{key:a},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedScenes,expression:"selectedScenes"}],attrs:{type:"checkbox",id:"scene"+a},domProps:{value:t.name,checked:Array.isArray(e.selectedScenes)?e._i(e.selectedScenes,t.name)>-1:e.selectedScenes},on:{change:function(s){var a=e.selectedScenes,n=s.target,c=!!n.checked;if(Array.isArray(a)){var r=t.name,o=e._i(a,r);n.checked?o<0&&(e.selectedScenes=a.concat([r])):o>-1&&(e.selectedScenes=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedScenes=c}}}),s("label",{attrs:{for:"scene"+a}},[e._v(e._s(t.name))])])})),0),s("h3",[e._v("Characters")]),s("ul",e._l(e.story.characters,(function(t,a){return s("li",{key:a},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedCharacters,expression:"selectedCharacters"}],attrs:{type:"checkbox",id:"character"+a},domProps:{value:t.name,checked:Array.isArray(e.selectedCharacters)?e._i(e.selectedCharacters,t.name)>-1:e.selectedCharacters},on:{change:function(s){var a=e.selectedCharacters,n=s.target,c=!!n.checked;if(Array.isArray(a)){var r=t.name,o=e._i(a,r);n.checked?o<0&&(e.selectedCharacters=a.concat([r])):o>-1&&(e.selectedCharacters=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedCharacters=c}}}),s("label",{attrs:{for:"character"+a}},[e._v(e._s(t.name))])])})),0)])},De=[],Ee=(s("b64b"),s("b85c")),Ne={data:function(){return{assetPack:{id:Object(h["a"])(),scenes:[],characters:[]},story:{},selectedScenesToDelete:[],selectedCharactersToDelete:[],selectedScenes:[],selectedCharacters:[]}},mounted:function(){var e=this.$route.params.assetId;"new"!==e&&(this.assetPack=this.$store.getters.assetPack(e)),this.story=this.$store.getters.story},computed:{hasAssetPack:function(){return Object.keys(this.assetPack).length>0}},methods:{createNew:function(){this.assetPack={name:""}},addUpdateAssetPack:function(){var e,t=Object(Ee["a"])(this.selectedScenes);try{for(t.s();!(e=t.n()).done;){var s=e.value;this.assetPack.scenes.push(this.story.scenes.find((function(e){return e.name===s})))}}catch(r){t.e(r)}finally{t.f()}var a,n=Object(Ee["a"])(this.selectedCharacters);try{for(n.s();!(a=n.n()).done;){var c=a.value;this.assetPack.characters.push(this.story.characters.find((function(e){return e.name===c})))}}catch(r){n.e(r)}finally{n.f()}},save:function(){this.$store.commit("updateAssetPack",this.assetPack),this.$router.push("/assets/view/"+this.assetPack.id)},removeAssets:function(){var e,t=Object(Ee["a"])(this.selectedScenesToDelete);try{for(t.s();!(e=t.n()).done;){var s=e.value;this.assetPack.scenes.splice(this.assetPack.scenes.indexOf(s),1)}}catch(r){t.e(r)}finally{t.f()}var a,n=Object(Ee["a"])(this.selectedCharactersToDelete);try{for(n.s();!(a=n.n()).done;){var c=a.value;this.assetPack.characters.splice(this.assetPack.characters.indexOf(c),1)}}catch(r){n.e(r)}finally{n.f()}},back:function(){this.story.title?this.$router.push("/menu"):this.$router.push("/")}}},Le=Ne,Ke=Object(i["a"])(Le,Te,De,!1,null,null,null),Re=Ke.exports,Fe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v(e._s(e.assetPack.name))]),s("span",{staticClass:"buttons"},[s("button",{staticClass:"button",attrs:{title:"Imports selected assets into current project"},on:{click:e.importToProject}},[e._v("Import to Project")]),s("button",{staticClass:"button",attrs:{title:"Edit this asset pack"},on:{click:e.edit}},[e._v("Edit")]),s("button",{staticClass:"button",attrs:{title:"Upload this asset pack to the cloud for others to access"},on:{click:e.uploadToFirebase}},[e._v("Upload to Cloud")]),s("button",{staticClass:"button danger",attrs:{title:"Remove this asset pack permanently"},on:{click:e.deletePack}},[e._v("Delete")]),s("button",{staticClass:"button",on:{click:e.back}},[e._v("Back")])]),s("h3",[e._v("Scenes")]),s("ul",e._l(e.assetPack.scenes,(function(t,a){return s("li",{key:a},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedScenes,expression:"selectedScenes"}],attrs:{type:"checkbox",id:"scene"+a},domProps:{value:t.name,checked:Array.isArray(e.selectedScenes)?e._i(e.selectedScenes,t.name)>-1:e.selectedScenes},on:{change:function(s){var a=e.selectedScenes,n=s.target,c=!!n.checked;if(Array.isArray(a)){var r=t.name,o=e._i(a,r);n.checked?o<0&&(e.selectedScenes=a.concat([r])):o>-1&&(e.selectedScenes=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedScenes=c}}}),s("label",{attrs:{for:"scene"+a}},[e._v(e._s(t.name))])])})),0),s("h3",[e._v("Characters")]),s("ul",e._l(e.assetPack.characters,(function(t,a){return s("li",{key:a},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedCharacters,expression:"selectedCharacters"}],attrs:{type:"checkbox",id:"character"+a},domProps:{value:t.name,checked:Array.isArray(e.selectedCharacters)?e._i(e.selectedCharacters,t.name)>-1:e.selectedCharacters},on:{change:function(s){var a=e.selectedCharacters,n=s.target,c=!!n.checked;if(Array.isArray(a)){var r=t.name,o=e._i(a,r);n.checked?o<0&&(e.selectedCharacters=a.concat([r])):o>-1&&(e.selectedCharacters=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedCharacters=c}}}),s("label",{attrs:{for:"character"+a}},[e._v(e._s(t.name))])])})),0)])},Ue=[],Be=(s("4160"),s("159b"),s("96cf"),s("1da1")),Je=s("8aa5"),ze=s.n(Je),We={saveAssetPack:function(e){window.console.log("Firebase # saveAssetPack"),window.console.log(e);var t,s=ze.a.firestore(),a=JSON.parse(JSON.stringify(e)),n=Object(Ee["a"])(a.scenes);try{for(n.s();!(t=n.n()).done;){var c=t.value;this.saveImage(s,c),a.scenes.splice(a.scenes.indexOf(c),1,c.id)}}catch(l){n.e(l)}finally{n.f()}var r,o=Object(Ee["a"])(a.characters);try{for(o.s();!(r=o.n()).done;){var i=r.value;this.saveImage(s,i),a.characters.splice(a.characters.indexOf(i),1,i.id)}}catch(l){o.e(l)}finally{o.f()}s.collection("assetPacks").doc(e.id).set(a),s.collection("assetPackKeys").doc(e.id).set({id:e.id,name:e.name})},loadAssetPack:function(e){var t=this;return Object(Be["a"])(regeneratorRuntime.mark((function s(){var a,n,c,r,o,i,l,u,d,h;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return window.console.log("Firebase # loadAssetPack("+e+")"),a={},n=ze.a.firestore(),s.next=5,n.collection("assetPacks").doc(e).get().then((function(e){return a=e.exists?e.data():{}})).catch((function(e){return window.console.log("Error",e)}));case 5:c=Object(Ee["a"])(a.characters),s.prev=6,c.s();case 8:if((r=c.n()).done){s.next=16;break}return o=r.value,s.next=12,t.loadImage(n,o);case 12:i=s.sent,a.characters.splice(a.characters.indexOf(o),1,i);case 14:s.next=8;break;case 16:s.next=21;break;case 18:s.prev=18,s.t0=s["catch"](6),c.e(s.t0);case 21:return s.prev=21,c.f(),s.finish(21);case 24:l=Object(Ee["a"])(a.scenes),s.prev=25,l.s();case 27:if((u=l.n()).done){s.next=35;break}return d=u.value,s.next=31,t.loadImage(n,d);case 31:h=s.sent,a.scenes.splice(a.scenes.indexOf(d),1,h);case 33:s.next=27;break;case 35:s.next=40;break;case 37:s.prev=37,s.t1=s["catch"](25),l.e(s.t1);case 40:return s.prev=40,l.f(),s.finish(40);case 43:return s.abrupt("return",a);case 44:case"end":return s.stop()}}),s,null,[[6,18,21,24],[25,37,40,43]])})))()},getAssetPackList:function(){window.console.log("Firebase # getAssetPackList");var e=[],t=ze.a.firestore();return t.collection("assetPackKeys").get().then((function(t){return t.forEach((function(t){return e.push(t.data())}))})).catch((function(e){return window.console.log("Error",e)})),e},saveImage:function(e,t){window.console.log("Firebase # saveImage"),window.console.log(t),e.collection("images").doc(t.id).set(t)},loadImage:function(e,t){return Object(Be["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a={},s.next=3,e.collection("images").doc(t).get().then((function(e){return a=e.exists?e.data():{}})).catch((function(e){return window.console.log("Error",e)}));case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}}),s)})))()}},qe={data:function(){return{assetPack:{},selectedScenes:[],selectedCharacters:[]}},mounted:function(){var e=this.$route.params.assetId;window.console.log(e),this.assetPack=this.$store.getters.assetPack(e)},methods:{importToProject:function(){var e,t={scenes:[],characters:[]},s=Object(Ee["a"])(this.selectedScenes);try{for(s.s();!(e=s.n()).done;){var a=e.value;t.scenes.push(this.assetPack.scenes.find((function(e){return e.name===a})))}}catch(o){s.e(o)}finally{s.f()}var n,c=Object(Ee["a"])(this.selectedCharacters);try{for(c.s();!(n=c.n()).done;){var r=n.value;t.characters.push(this.assetPack.characters.find((function(e){return e.name===r})))}}catch(o){c.e(o)}finally{c.f()}window.console.log("updating"),window.console.log(t),this.$store.commit("importAssetsToStory",t),this.$router.push("/edit")},edit:function(){this.$router.push("/assets/update/"+this.assetPack.id)},deletePack:function(){this.$store.commit("deleteAssetPack",this.assetPack.id),this.$router.push("/")},back:function(){this.$store.getters.story.title?this.$router.push("/menu"):this.$router.push("/")},uploadToFirebase:function(){window.console.log("click uploadToFirebase"),We.saveAssetPack(this.assetPack)},clickMe:function(){window.console.log("click me")}}},He=qe,Qe=Object(i["a"])(He,Fe,Ue,!1,null,null,null),Ve=Qe.exports,Ye=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("h1",[e._v("Download asset packs")]),e._l(e.assetPackList,(function(t){return s("button",{key:t.id,staticClass:"wideMenu button",on:{click:function(s){return e.download(t)}}},[e._v("Download "+e._s(t.name))])}))],2)},Ge=[],Xe={data:function(){return{assetPackList:[]}},mounted:function(){this.assetPackList=We.getAssetPackList()},methods:{download:function(e){var t=this;return Object(Be["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,We.loadAssetPack(e.id);case 2:a=s.sent,window.console.log(a),t.$store.commit("updateAssetPack",a),t.$router.push("/assets/view/"+a.id);case 6:case"end":return s.stop()}}),s)})))()}}},Ze=Xe,et=Object(i["a"])(Ze,Ye,Ge,!1,null,null,null),tt=et.exports,st=[{path:"/",component:D},{path:"/menu",component:q},{path:"/edit",component:X},{path:"/edit/scenes",component:ne},{path:"/edit/characters",component:ke},{path:"/edit/plan",component:Pe},{path:"/play",component:Ie},{path:"/assets/update/:assetId",component:Re},{path:"/assets/view/:assetId",component:Ve},{path:"/assets/download",component:tt}],at=new _["a"]({mode:"hash",routes:st});a["a"].use(_["a"]);var nt=at;a["a"].config.productionTip=!1;var ct={apiKey:"AIzaSyDdFELo568ztJgq07FAO8mhRyUq8TKUeyQ",authDomain:"storymaker-3002d.firebaseapp.com",databaseURL:"https://storymaker-3002d.firebaseio.com",projectId:"storymaker-3002d",storageBucket:"storymaker-3002d.appspot.com",messagingSenderId:"846763549713",appId:"1:846763549713:web:581d08961adbee051efdb0"};ze.a.initializeApp(ct),new a["a"]({store:b,router:nt,render:function(e){return e(u)}}).$mount("#app")},"5c0b":function(e,t,s){"use strict";var a=s("9c0c"),n=s.n(a);n.a},"66dc":function(e,t,s){"use strict";var a=s("dc2a"),n=s.n(a);n.a},"83d7":function(e,t,s){"use strict";var a=s("acb9"),n=s.n(a);n.a},"9c0c":function(e,t,s){},acb9:function(e,t,s){},dc2a:function(e,t,s){}});
//# sourceMappingURL=app.a8137062.js.map
(function(t){function e(e){for(var n,o,i=e[0],c=e[1],l=e[2],d=0,h=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&h.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,i=1;i<a.length;i++){var c=a[i];0!==s[c]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},s={app:0},r=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1712:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],o={name:"App"},i=o,c=(a("5c0b"),a("2877")),l=Object(c["a"])(i,s,r,!1,null,null,null),u=l.exports,d=a("2f62");n["a"].use(d["a"]);var h=new d["a"].Store({state:{story:{scenes:[],characters:[],plan:[]}},getters:{story:function(t){return t.story}},mutations:{update:function(t,e){t.story=e}}}),p=a("8c4f"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("h1",[t._v("Story Maker")]),a("p",[t._v("Loaded Story: "+t._s(t.story.title))]),a("button",{staticClass:"wideMenu button",on:{click:function(e){return t.$router.push("/edit")}}},[t._v("Edit")]),a("button",{staticClass:"wideMenu button",on:{click:function(e){return t.$router.push("/play")}}},[t._v("Play")])])},m=[],v={data:function(){return{story:{}}},mounted:function(){this.story=this.$store.getters.story}},g=v,w=Object(c["a"])(g,f,m,!1,null,null,null),y=w.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("h1",[t._v("Story Maker - Editor")]),a("span",{staticClass:"buttons"},[a("button",{staticClass:"button",on:{click:t.downloadStory}},[t._v("Save")]),a("UploadFile",{attrs:{text:!0,id:"uploadStory"},model:{value:t.uploadStory,callback:function(e){t.uploadStory=e},expression:"uploadStory"}}),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/play")}}},[t._v("Play")]),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/")}}},[t._v("Back")])],1),a("span",{staticClass:"field"},[a("label",[t._v("Story title")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.story.title,expression:"story.title"}],attrs:{type:"text"},domProps:{value:t.story.title},on:{input:function(e){e.target.composing||t.$set(t.story,"title",e.target.value)}}})]),a("h2",[t._v("Scenes")]),a("p",[t._v(t._s(t.story.scenes?t.story.scenes.length:0)+" scenes")]),a("ul",t._l(t.story.scenes,(function(e,n){return a("li",{key:n},[t._v(t._s(e.name))])})),0),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/edit/scenes")}}},[t._v("Edit Scenes")]),a("h2",[t._v("Characters")]),a("p",[t._v(t._s(t.story.characters?t.story.characters.length:0)+" characters")]),a("ul",t._l(t.story.characters,(function(e,n){return a("li",{key:n},[t._v(t._s(e.name))])})),0),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/edit/characters")}}},[t._v("Edit Characters")]),a("h2",[t._v("Plan")]),a("p",[t._v(t._s(t.story.plan?t.story.plan.length:0)+" steps in plan")]),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/edit/plan")}}},[t._v("Edit Plan")])])},x=[],_=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"upload"},[a("input",{attrs:{id:t.getId,type:"file"},on:{change:function(e){return t.uploadFile(e)}}}),a("label",{staticClass:"button",attrs:{for:t.getId}},[t._v("Upload")])])}),C=[],S={props:["value","text","id"],data:function(){return{reader:new FileReader}},mounted:function(){this.reader.addEventListener("load",this.whenFileLoaded,!1)},computed:{getId:function(){return this.id?this.id:"file"}},methods:{uploadFile:function(t){var e=t.target.files[0];this.text?this.reader.readAsText(e):this.reader.readAsDataURL(e)},whenFileLoaded:function(){this.$emit("input",this.reader.result)}}},k=S,$=Object(c["a"])(k,_,C,!1,null,null,null),O=$.exports,M={name:"Editor",components:{UploadFile:O},data:function(){return{uploadStory:"",story:{}}},mounted:function(){this.story=this.$store.getters.story},watch:{uploadStory:function(t){this.story=JSON.parse(t),this.$store.commit("update",this.story)}},methods:{downloadStory:function(){this.download(JSON.stringify(this.story),"my","story")},download:function(t,e,a){var n=new Blob([t],{type:a});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,e);else{var s=document.createElement("a"),r=URL.createObjectURL(n);s.href=r,s.download=e,document.body.appendChild(s),s.click(),setTimeout((function(){document.body.removeChild(s),window.URL.revokeObjectURL(r)}),0)}}}},j=M,I=Object(c["a"])(j,b,x,!1,null,null,null),P=I.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("h2",[t._v("Scenes")]),a("span",{staticClass:"buttons"},[a("button",{staticClass:"button",on:{click:t.addScene}},[t._v("New Scene")]),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/edit")}}},[t._v("Back")])]),a("ul",{staticClass:"editlist box"},t._l(t.scenes,(function(e,n){return a("li",{key:n},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"scene.name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:e.name},on:{input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}}),a("img",{attrs:{src:e.image}}),a("UploadFile",{attrs:{id:"uploadScene"+n},model:{value:e.image,callback:function(a){t.$set(e,"image",a)},expression:"scene.image"}})],1)})),0)])},N=[],F={components:{UploadFile:O},data:function(){return{scenes:[],checkedScenes:[]}},mounted:function(){this.scenes=this.$store.getters.story.scenes},methods:{addScene:function(){this.scenes.push({name:"",image:""})}}},U=F,R=(a("afdb"),Object(c["a"])(U,E,N,!1,null,"0aba33fe",null)),T=R.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("h2",[t._v("Characters")]),a("span",{staticClass:"buttons"},[a("button",{staticClass:"button",on:{click:t.addCharacter}},[t._v("New Character")]),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/edit")}}},[t._v("Back")])]),a("ul",{staticClass:"editlist box"},t._l(t.characters,(function(e,n){return a("li",{key:n},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"character.name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:e.name},on:{input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}}),a("img",{attrs:{src:e.image}}),a("span",{staticClass:"field"},[a("label",[t._v("Speech Box Colour")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.colour,expression:"character.colour"}],attrs:{type:"color"},domProps:{value:e.colour},on:{input:function(a){a.target.composing||t.$set(e,"colour",a.target.value)}}})]),a("span",{staticClass:"field"},[a("label",[t._v("Y-Offset")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.yoffset,expression:"character.yoffset"}],attrs:{type:"number"},domProps:{value:e.yoffset},on:{input:function(a){a.target.composing||t.$set(e,"yoffset",a.target.value)}}})]),a("span",{staticClass:"field"},[a("label",[t._v("Scale")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.scale,expression:"character.scale"}],attrs:{type:"number"},domProps:{value:e.scale},on:{input:function(a){a.target.composing||t.$set(e,"scale",a.target.value)}}})]),a("Canvas",{attrs:{id:"canvas"+n,width:304,height:190,character:e,text:"Hi"}}),a("UploadFile",{attrs:{id:"uploadCharacter"+n},model:{value:e.image,callback:function(a){t.$set(e,"image",a)},expression:"character.image"}})],1)})),0)])},B=[],L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("canvas",{attrs:{id:t.id,width:t.width,height:t.height},on:{click:function(e){return t.$emit("nextStep")}}})},D=[],J=a("1157"),W=a.n(J),z=a("acea"),H=a.n(z);H()(W.a,window);var Y={props:["id","width","height","scene","character","text"],data:function(){return{characterImageMeta:{width:0,height:0}}},mounted:function(){window.console.log(""),window.console.log(this.id+" mounted"),this.loadMetadata(),this.draw()},watch:{scene:{handler:function(){window.console.log(""),window.console.log(this.id+" scene updated"),this.draw()},deep:!0},character:{handler:function(){window.console.log(""),window.console.log(this.id+" character updated"),this.loadMetadata()},deep:!0},characterImageMeta:{handler:function(){window.console.log(""),window.console.log(this.id+" image meta updated"),this.draw()},deep:!0},text:function(){window.console.log(""),window.console.log(this.id+" text updated"),this.draw()}},computed:{xscale:function(){return this.width/800},yscale:function(){return this.height/500}},methods:{draw:function(){window.console.log(this.id+" draw ******"),window.console.log("scene? "+(!1!==this.scene)),window.console.log("character? "+(!1!==this.character));var t=this.id?W()("#"+this.id):W()("canvas");t.clearCanvas(),this.drawBorder(t),this.drawScene(t),this.drawCharacter(t),this.drawText(t)},drawBorder:function(t){t.drawRect({strokeStyle:"#c33",strokeWidth:1,x:1,y:1,width:this.width-2,height:this.height-2,fromCenter:!1})},drawScene:function(t){this.scene&&this.scene.image&&t.drawImage({source:this.scene.image,x:2,y:2,width:this.width-4,height:this.height-4,scale:1,fromCenter:!1})},drawCharacter:function(t){this.character&&this.character.image&&(window.console.log("width: "+this.characterImageMeta.width*this.xscale),window.console.log("height: "+this.characterImageMeta.height*this.yscale),t.drawImage({source:this.character.image,x:10*this.xscale,y:200*this.yscale,width:this.characterImageMeta.width*this.xscale,height:this.characterImageMeta.height*this.yscale,fromCenter:!1}))},drawText:function(t){var e=this.character.colour?this.character.colour:"#69A0D7",a="#2D4258",n="#ECF3FA";t.drawRect({fillStyle:e,x:20*this.xscale,y:20*this.yscale,width:770*this.xscale,height:80*this.yscale,fromCenter:!1,cornerRadius:4}),t.drawRect({strokeStyle:a,x:24*this.xscale,y:24*this.yscale,width:762*this.xscale,height:72*this.yscale,fromCenter:!1,cornerRadius:2}),t.drawText({name:"drawText",fillStyle:n,strokeWidth:1,x:34*this.xscale,y:34*this.yscale,fontSize:18*this.xscale+"pt",fromCenter:!1,text:'"'+this.text+'"'}),t.drawText({name:"drawText",fillStyle:n,strokeWidth:1,x:45*this.xscale,y:74*this.yscale,fontSize:18*this.xscale+"pt",text:"..."})},loadMetadata:function(){var t=this,e=new Image;e.onload=function(){window.console.log("loaded metadata"),t.characterImageMeta.width=e.width,t.characterImageMeta.height=e.height},e.src=this.character.image}}},q=Y,G=Object(c["a"])(q,L,D,!1,null,null,null),K=G.exports,Q={components:{UploadFile:O,Canvas:K},data:function(){return{characters:[]}},mounted:function(){this.characters=this.$store.getters.story.characters},methods:{addCharacter:function(){this.characters.push({name:"",image:"",colour:"#69A0D7",yoffset:0,scale:1})}}},V=Q,X=(a("7bd5"),Object(c["a"])(V,A,B,!1,null,"5ddb90e3",null)),Z=X.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("h2",[t._v("Plan")]),a("span",{staticClass:"buttons"},[a("button",{staticClass:"button",on:{click:t.newItem}},[t._v("New")]),a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/edit")}}},[t._v("Back")])]),a("ul",{staticClass:"editlist"},t._l(t.plan,(function(e,n){return a("li",{key:n},[a("span",{staticClass:"number"},[t._v(t._s(n+1))]),a("span",{staticClass:"content"},[void 0!==e.scene?a("span",{staticClass:"field"},[a("label",[t._v("Scene: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.scene,expression:"item.scene"}],on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"scene",a.target.multiple?n:n[0])}}},t._l(t.scenes,(function(e,n){return a("option",{key:n},[t._v(t._s(e.name))])})),0)]):a("button",{staticClass:"button small",on:{click:function(a){return t.changeScene(e)}}},[t._v("Change scene")]),void 0!==e.character?a("span",{staticClass:"field"},[a("label",[t._v("Character: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.character,expression:"item.character"}],on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"character",a.target.multiple?n:n[0])}}},t._l(t.characters,(function(e,n){return a("option",{key:n},[t._v(t._s(e.name))])})),0)]):a("button",{staticClass:"button small",on:{click:function(a){return t.changeCharacter(e)}}},[t._v("Change character")]),a("span",{staticClass:"field"},[a("label",[t._v("Message: ")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"item.text"}],domProps:{value:e.text},on:{input:function(a){a.target.composing||t.$set(e,"text",a.target.value)}}})])])])})),0)])},et=[],at={data:function(){return{plan:[],scenes:[],characters:[]}},mounted:function(){this.plan=this.$store.getters.story.plan,this.scenes=this.$store.getters.story.scenes,this.characters=this.$store.getters.story.characters},methods:{newItem:function(){this.plan.push({scene:void 0,character:void 0,text:""})},changeScene:function(t){t.scene=""},changeCharacter:function(t){t.character=""}}},nt=at,st=Object(c["a"])(nt,tt,et,!1,null,null,null),rt=st.exports,ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("h1",[t._v(t._s(t.story.title))]),a("span",{staticClass:"buttons"},[a("button",{staticClass:"button",on:{click:function(e){return t.$router.push("/")}}},[t._v("Stop")])]),a("Canvas",{attrs:{id:"canvas1",width:800,height:500,scene:this.scene,character:this.character,text:t.text},on:{nextStep:t.nextStep}})],1)},it=[];a("7db0"),a("b0c0");H()(W.a,window);var ct={name:"Play",components:{Canvas:K},data:function(){return{story:{},scene:{},character:{},characterImageMeta:{width:0,height:0},text:"",index:0}},mounted:function(){this.story=this.$store.getters.story,this.update()},methods:{update:function(){var t=this.story.plan[this.index];t.scene&&(this.scene=this.story.scenes.find((function(e){return e.name===t.scene}))),t.character&&(this.character=this.story.characters.find((function(e){return e.name===t.character}))),t.text&&(this.text=t.text),this.loadMetadataAndDraw()},nextStep:function(){this.index++,this.index>=this.story.plan.length?this.$router.push("/"):this.update()},loadMetadataAndDraw:function(){var t=this,e=new Image;e.onload=function(){t.characterImageMeta.width=e.width,t.characterImageMeta.height=e.height},e.src=this.character.image}}},lt=ct,ut=Object(c["a"])(lt,ot,it,!1,null,null,null),dt=ut.exports,ht=[{path:"/",component:y},{path:"/edit",component:P},{path:"/edit/scenes",component:T},{path:"/edit/characters",component:Z},{path:"/edit/plan",component:rt},{path:"/play",component:dt}],pt=new p["a"]({mode:"history",routes:ht});n["a"].use(p["a"]);var ft=pt;n["a"].config.productionTip=!1,new n["a"]({store:h,router:ft,render:function(t){return t(u)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var n=a("9c0c"),s=a.n(n);s.a},"7bd5":function(t,e,a){"use strict";var n=a("c7d1"),s=a.n(n);s.a},"9c0c":function(t,e,a){},afdb:function(t,e,a){"use strict";var n=a("1712"),s=a.n(n);s.a},c7d1:function(t,e,a){}});
//# sourceMappingURL=app.0170e85c.js.map